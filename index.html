<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>NPS - CearaGPS</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>

<body class="min-h-screen flex flex-col bg-gradient-to-tr from-[#00708B] to-[#003041]">

    <!-- HEADER -->
    <header class="w-screen h-32 flex items-center justify-center">
        <img src="logocgps.png" class="block sm:max-w-md lg:max-w-2xl object-contain">
    </header>

    <!-- MAIN -->
    <main class="flex-1 flex items-center justify-center px-2 sm:px-4 overflow-y-auto">

        <!-- WRAPPER RESPONSIVO GLOBAL -->
        <div class="
        w-full
        max-w-[420px]
        sm:max-w-[560px]
        md:max-w-[760px]
        lg:max-w-[900px]
        xl:max-w-[960px]
        mx-auto
        flex
        flex-col
        gap-6
        px-4
        sm:px-6
        md:px-8
      ">

            <!-- CARD CPF / CNPJ -->
            <div id="card-identificacao" class="
          w-full
          bg-[#ECECEC]
          rounded-2xl
          shadow-2xl
          p-6 md:p-8
          text-center
        ">
                <h1 class="text-[#00465D] font-semibold text-lg md:text-2xl mb-6">
                    Informe seu CPF ou CNPJ
                </h1>

                <input id="documento" type="text" placeholder="CPF ou CNPJ" class="
            w-full
            max-w-md
            mx-auto
            block
            p-4
            rounded-xl
            border border-gray-300
            text-center
            text-base md:text-lg
            focus:outline-none
            focus:ring-2
            focus:ring-[#FF4302]
          " />

                <button onclick="confirmarDocumento()" class="
            mt-6
            bg-[#FF4302]
            text-white
            px-8
            py-3
            rounded-xl
            font-semibold
            transition
            hover:opacity-90
            active:scale-95
          ">
                    Confirmar
                </button>
            </div>

            <!-- CARD NPS -->
            <div id="card-nps" class="
          hidden
          w-full
          bg-[#ECECEC]
          rounded-2xl
          shadow-2xl
          p-6 md:p-8
          text-center
        ">
                <h1 class="text-[#00465D] text-xl md:text-2xl font-semibold mb-8">
                    Como foi sua experi√™ncia com a CearaGPS hoje?
                </h1>

                <div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-5 gap-4">
                    <button onclick="enviarNPS(1)" class="card-nps">üò°<span>Muito ruim</span></button>
                    <button onclick="enviarNPS(2)" class="card-nps">üòï<span>Ruim</span></button>
                    <button onclick="enviarNPS(3)" class="card-nps">üòê<span>Regular</span></button>
                    <button onclick="enviarNPS(4)" class="card-nps">üòÄ<span>Boa</span></button>
                    <button onclick="enviarNPS(5)" class="card-nps">üòç<span>Excelente</span></button>
                </div>
            </div>

        </div>
    </main>

    <!-- FOOTER -->
    <footer class="w-screen h-32 bg-[#FF4302]">
        <div class="h-32 w-full bg-no-repeat bg-contain bg-center" style="background-image: url('footer.png');"></div>
    </footer>

    <!-- JS -->
    <script>
        const webhookUrl = "https://webhook.gpsceara.shop/webhook/whnps";
        let documentoInformado = "";

        // M√°scara CPF / CNPJ
        document.getElementById("documento").addEventListener("input", (e) => {
            let v = e.target.value.replace(/\D/g, "");

            if (v.length <= 11) {
                v = v.replace(/(\d{3})(\d)/, "$1.$2");
                v = v.replace(/(\d{3})(\d)/, "$1.$2");
                v = v.replace(/(\d{3})(\d{1,2})$/, "$1-$2");
            } else {
                v = v.replace(/^(\d{2})(\d)/, "$1.$2");
                v = v.replace(/^(\d{2})\.(\d{3})(\d)/, "$1.$2.$3");
                v = v.replace(/\.(\d{3})(\d)/, ".$1/$2");
                v = v.replace(/(\d{4})(\d)/, "$1-$2");
            }

            e.target.value = v;
        });

        function confirmarDocumento() {
            const input = document.getElementById("documento").value;

            if (input.replace(/\D/g, "").length < 11) {
                alert("Informe um CPF ou CNPJ v√°lido.");
                return;
            }

            documentoInformado = input;

            document.getElementById("card-identificacao").classList.add("hidden");
            document.getElementById("card-nps").classList.remove("hidden");
        }

        function horaavaliacao() {
            return new Date().toLocaleString("sv-SE", {
                timeZone: "America/Fortaleza"
            }).replace(" ", "T");
        }


        function enviarNPS(nota) {
            fetch(webhookUrl, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                    documento_cpf: documentoInformado,
                    nota_nps: nota,
                    hora_avaliacao: horaavaliacao()
                })
            });

            document.getElementById("card-nps").innerHTML = `
        <h1 class="text-[#00465D] text-xl md:text-2xl font-semibold">
          Obrigado pela sua avalia√ß√£o!
        </h1>
        <p class="mt-4 text-[#00465D]">
          Sua opini√£o √© muito importante para n√≥s.
        </p>
      `;

            setTimeout(() => location.reload(), 4000);
        }
    </script>

    <!-- CARD NPS STYLE -->
    <style>
        .card-nps {
            background: white;
            border-radius: 1rem;
            padding: 1.25rem;
            display: flex;
            flex-direction: column;
            align-items: center;
            font-size: 2.5rem;
            transition: all .2s;
            box-shadow: 0 2px 8px rgba(0, 0, 0, .12);
            border: 2px solid transparent;
        }

        .card-nps span {
            margin-top: .5rem;
            font-size: .875rem;
            color: #00465D;
        }

        .card-nps:hover {
            transform: scale(1.05);
            box-shadow: 0 8px 20px rgba(0, 0, 0, .25);
            border-color: #FF4302;
        }
    </style>

</body>

</html>